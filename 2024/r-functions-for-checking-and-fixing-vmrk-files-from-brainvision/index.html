<!DOCTYPE html>
<html lang="en-uk">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.7.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Pablo Bernabeu">

  
  
  
    
  
  <meta name="description" content="Electroencephalography (EEG) has become a cornerstone for understanding the intricate workings of the human brain in the field of neuroscience. However, EEG software and hardware come with their own set of constraints, particularly in the management of markers, also known as triggers. This article aims to shed light on these limitations and future prospects of marker management in EEG studies, while also introducing R functions that can help deal with vmrk files from BrainVision.">

  
  
  <meta name="indexnow-key" content="ba7d2697a8f44966bd90543d188a8aac">
  <meta name="indexnow-host" content="pablobernabeu.github.io">
  <meta name="indexnow-key-location" content="https://pablobernabeu.github.io/ba7d2697a8f44966bd90543d188a8aac.txt">
  

  
  <link rel="alternate" hreflang="en-uk" href="https://pablobernabeu.github.io/2024/r-functions-for-checking-and-fixing-vmrk-files-from-brainvision/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu125e1cde4fb125eb9c515e372e2310e0_537990_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu125e1cde4fb125eb9c515e372e2310e0_537990_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://pablobernabeu.github.io/2024/r-functions-for-checking-and-fixing-vmrk-files-from-brainvision/">

  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Pablo Bernabeu">
  <meta property="og:url" content="https://pablobernabeu.github.io/2024/r-functions-for-checking-and-fixing-vmrk-files-from-brainvision/">
  <meta property="og:title" content="R functions for checking and fixing vmrk files from BrainVision | Pablo Bernabeu">
  <meta property="og:description" content="Electroencephalography (EEG) has become a cornerstone for understanding the intricate workings of the human brain in the field of neuroscience. However, EEG software and hardware come with their own set of constraints, particularly in the management of markers, also known as triggers. This article aims to shed light on these limitations and future prospects of marker management in EEG studies, while also introducing R functions that can help deal with vmrk files from BrainVision."><meta property="og:image" content="https://pablobernabeu.github.io/img/default_preview_image.png">
  <meta property="twitter:image" content="https://pablobernabeu.github.io/img/default_preview_image.png"><meta property="og:locale" content="en-uk">
  
    
      <meta property="article:published_time" content="2024-06-30T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2024-06-30T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://pablobernabeu.github.io/2024/r-functions-for-checking-and-fixing-vmrk-files-from-brainvision/"
  },
  "headline": "R functions for checking and fixing vmrk files from BrainVision",
  
  "datePublished": "2024-06-30T00:00:00Z",
  "dateModified": "2024-06-30T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Pablo Bernabeu"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Pablo Bernabeu",
    "logo": {
      "@type": "ImageObject",
      "url": "https://pablobernabeu.github.io/images/icon_hu125e1cde4fb125eb9c515e372e2310e0_537990_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "Electroencephalography (EEG) has become a cornerstone for understanding the intricate workings of the human brain in the field of neuroscience. However, EEG software and hardware come with their own set of constraints, particularly in the management of markers, also known as triggers. This article aims to shed light on these limitations and future prospects of marker management in EEG studies, while also introducing R functions that can help deal with vmrk files from BrainVision."
}
</script>

  

  


  


   
<script>
  (function () {
    "use strict";

    function getThemeMode() {
      return parseInt(localStorage.getItem("dark_mode") || 2);
    }

    function shouldUseDarkTheme() {
      let currentThemeMode = getThemeMode();
      switch (currentThemeMode) {
        case 0:
          return false; 
        case 1:
          return true; 
        default:
          if (localStorage.getItem("dark_mode") === null) {
            return false; 
          }
          return (
            window.matchMedia &&
            window.matchMedia("(prefers-color-scheme: dark)").matches
          );
      }
    }

    
    if (shouldUseDarkTheme()) {
      document.documentElement.setAttribute("data-theme", "dark");
      document.documentElement.style.backgroundColor = "#0f172a";
      document.documentElement.style.color = "#e2e8f0";
    }
  })();
</script>

<link rel="stylesheet" href="/css/publication-type-badges.css">
<link rel="stylesheet" href="/css/custom-nav.css">
<script src="/js/open-science-badges.js" defer></script>
<script src="/js/publication-type-badge-colors.js" defer></script>
<script src="/js/publication-type-badge-popup.js" defer></script>
<script src="/js/github-button-fix.js" defer></script>
<script src="/js/abstract-heading-style.js" defer></script>



<link rel="stylesheet" href="/css/search-modal.css" />


<link rel="stylesheet" href="/css/tag-cloud-height.css" />


<script src="/js/tag-cloud-network.js"></script>


<script src="/js/article-ancillary-tags.js"></script>


<meta name="format-detection" content="telephone=no" />


<script>
  document.addEventListener("DOMContentLoaded", function () {
    setTimeout(function () {
      const searchModal = document.getElementById("search");
      if (!searchModal) return;

      let savedQuery = localStorage.getItem("searchQuery") || "";
      let savedResults = localStorage.getItem("searchResults") || "";
      window.searchModalPreventClose = false;

      
      function hasSearchResults() {
        const searchHits = document.getElementById("search-hits");
        return (
          searchHits && searchHits.querySelectorAll(".search-hit").length > 0
        );
      }

      
      function saveSearchResults() {
        const searchHits = document.getElementById("search-hits");
        if (searchHits && hasSearchResults()) {
          savedResults = searchHits.innerHTML;
          localStorage.setItem("searchResults", savedResults);
          console.log("Saved search results");
        }
      }

      
      function restoreSearchResults() {
        if (savedResults) {
          const searchHits = document.getElementById("search-hits");
          if (searchHits) {
            searchHits.innerHTML = savedResults;
            console.log("Restored search results");
          }
        }
      }

      
      function isModalVisible() {
        return (
          getComputedStyle(searchModal).display !== "none" &&
          searchModal.offsetParent !== null
        );
      }

      
      function saveQuery() {
        const searchInput = document.getElementById("search-query");
        if (searchInput && searchInput.value.trim()) {
          savedQuery = searchInput.value;
          localStorage.setItem("searchQuery", savedQuery);
          console.log("Saved query:", savedQuery);
        }
      }

      
      function forceRestoreQuery() {
        if (savedQuery) {
          const searchInput = document.getElementById("search-query");
          if (searchInput) {
            
            searchInput.value = savedQuery;
            searchInput.setAttribute("value", savedQuery);
            searchInput.defaultValue = savedQuery;

            console.log("Force restored query:", savedQuery);

            
            searchInput.dispatchEvent(new Event("input", { bubbles: true }));
          }
        }
      }

      
      const searchInput = document.getElementById("search-query");
      if (searchInput) {
        
        const originalDescriptor = Object.getOwnPropertyDescriptor(
          HTMLInputElement.prototype,
          "value"
        );

        
        Object.defineProperty(searchInput, "value", {
          get: function () {
            const currentValue = originalDescriptor.get.call(this);
            
            if (!currentValue && savedQuery && isModalVisible()) {
              console.log(
                "Intercepted empty value read, returning saved query:",
                savedQuery
              );
              return savedQuery;
            }
            return currentValue;
          },
          set: function (newValue) {
            console.log("Value being set to:", newValue);

            
            if (!newValue && savedQuery && isModalVisible()) {
              console.log(
                "BLOCKED attempt to clear input while modal is visible"
              );
              return; 
            }

            
            originalDescriptor.set.call(this, newValue);

            
            if (newValue && newValue.trim()) {
              savedQuery = newValue;
              localStorage.setItem("searchQuery", newValue);
              console.log("Saved new query via setter:", newValue);
            }
          },
          configurable: true,
        });

        searchInput.addEventListener("input", function () {
          if (this.value && this.value.trim()) {
            savedQuery = this.value;
            localStorage.setItem("searchQuery", this.value);
          }

          
          const hasResults = hasSearchResults();
          const hasQuery = this.value.trim().length > 0;
          window.searchModalPreventClose = hasResults || hasQuery;

          
          if (hasResults) {
            setTimeout(saveSearchResults, 200); 
          }
        });

        
        if (savedQuery) {
          originalDescriptor.set.call(searchInput, savedQuery);
        }
      }

      
      new MutationObserver(function (mutations) {
        mutations.forEach(function (mutation) {
          if (
            mutation.type === "attributes" &&
            (mutation.attributeName === "style" ||
              mutation.attributeName === "class")
          ) {
            const isVisible = isModalVisible();

            if (isVisible && !this.wasVisible) {
              
              console.log("Modal opened");
              if (savedQuery && searchInput) {
                
                const originalDescriptor = Object.getOwnPropertyDescriptor(
                  HTMLInputElement.prototype,
                  "value"
                );
                originalDescriptor.set.call(searchInput, savedQuery);

                
                if (savedResults) {
                  restoreSearchResults();
                }

                searchInput.dispatchEvent(
                  new Event("input", { bubbles: true })
                );
                console.log(
                  "Restored query and results on modal open:",
                  savedQuery
                );
              }
            }

            this.wasVisible = isVisible;
          }
        });
      }).observe(searchModal, {
        attributes: true,
        attributeFilter: ["style", "class"],
      });

      
      searchModal.addEventListener("click", function (e) {
        if (e.target === searchModal) {
          const hasResults = hasSearchResults();
          const hasQuery = searchInput && searchInput.value.trim().length > 0;

          if (hasResults || hasQuery) {
            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();
            return false;
          }
        }
      });

      
      document.addEventListener("keydown", function (e) {
        if (e.key === "Escape" && isModalVisible()) {
          saveQuery();
          saveSearchResults();
        }
      });

      
      const searchHits = document.getElementById("search-hits");
      if (searchHits) {
        new MutationObserver(function (mutations) {
          mutations.forEach(function (mutation) {
            if (mutation.type === "childList" && hasSearchResults()) {
              
              setTimeout(saveSearchResults, 300);
            }
          });
        }).observe(searchHits, { childList: true, subtree: true });
      }
    }, 1000);
  });
</script>

 
<script>
  window.addEventListener("load", function () {
    if (typeof IndexNowSubmission !== "undefined") {
      setTimeout(function () {
        IndexNowSubmission.submitCurrentPage();
      }, 2000);
    }
  });
</script>



  <title>R functions for checking and fixing vmrk files from BrainVision | Pablo Bernabeu</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="   Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>

  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Pablo Bernabeu</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Pablo Bernabeu</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#publication"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#applications-and-dashboards"><span><span data-toggle="tooltip1" data-placement="bottom" title=" &nbsp; Web applications and data dashboards &nbsp; ">Web Apps</span></span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#workshops"><span><span data-toggle="tooltip1" data-placement="bottom" title=" &nbsp; Presentations and workshops &nbsp; ">Presentations</span></span></a>
        </li>

        
        

        

        
        
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#bio"><span><span data-toggle="tooltip1" data-placement="bottom" title=" &nbsp; Contact &nbsp; | &nbsp; CV &nbsp; | &nbsp; Work &nbsp; | &nbsp; Education &nbsp; | &nbsp; Teaching and supervision &nbsp; | &nbsp; Funding &nbsp; | &nbsp; Other work &nbsp; | &nbsp; Skills &nbsp; ">CV+</span></span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#multimedia"><span><span data-toggle="tooltip1" data-placement="bottom" title=" &nbsp; Videos and podcasts &nbsp; ">Multimedia</span></span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#blog"><span><span data-toggle="tooltip1" data-placement="bottom" title=" &nbsp; Short essays &nbsp; | &nbsp; Tutorials &nbsp; | &nbsp; Inquiries &nbsp; | &nbsp; Functions for the implementation of experiments, data analysis and other purposes &nbsp; ">Resources</span></span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" title="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      <li class="nav-item dropdown">
        <a class="nav-link js-font-size-toggle" href="#"><i class="fas fa-text-height" aria-hidden="true"></i></a>
        <div class="dropdown-menu dropdown-menu-right font-size-menu">
          <a class="dropdown-item js-font-increase" href="#"><i class="fas fa-plus"></i> Increase font size</a>
          <a class="dropdown-item js-font-reset" href="#"><i class="fas fa-undo"></i> Reset</a>
          <a class="dropdown-item js-font-decrease" href="#"><i class="fas fa-minus"></i> Decrease font size</a>
        </div>
      </li>

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#" title="Toggle dark mode"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












<div class="article-container pt-3">
  <h1>R functions for checking and fixing vmrk files from BrainVision</h1>

  

  



  
  


<div class="article-metadata">

  
  

  
    
    
      
    
    
    <span style='font-size:100%;'>
      2024
    <span >
    
  

  

  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/research-methods/">research methods</a>, <a href="/categories/r/">R</a></span>
  

</div>

  














  
</div>



  <div class="article-container">

    <div class="article-style">
      


<p>Electroencephalography (EEG) has become a cornerstone for understanding the intricate workings of the human brain in the field of neuroscience. However, EEG software and hardware come with their own set of constraints, particularly in the management of markers, also known as triggers. This article aims to shed light on these limitations and future prospects of marker management in EEG studies, while also introducing R functions that can help deal with vmrk files from BrainVision.</p>
<p>Markers, serving as timestamps that indicate specific events during data collection, play a crucial role in EEG studies. These events could range from the onset of a stimulus to the participant’s response. However, one of the major constraints in current EEG systems is the limitation of markers to numbers between 1 and 255. This limitation is due to the fact that markers are typically stored as 8-bit unsigned integers in computer memory, which can only represent numbers in the range of 0 to 255. However, the number 0 is usually reserved for system use, leaving only the numbers 1 to 255 available for markers.</p>
<p>This numerical constraint can pose significant challenges in the interpretation of markers, especially in complex experimental designs where a multitude of events need to be marked and differentiated. It necessitates careful documentation of each marker’s purpose prior to running the study. This means that researchers must meticulously map each number to a specific event or condition in their experiment, which can be a daunting task, especially for complex studies with numerous conditions and events.</p>
<p>Looking towards the future, one might wonder if it will become possible to send markers with semantic information, instead of being constrained to numbers between 1 and 255. This would allow researchers to encode more detailed information in each marker, such as the type of stimulus presented or the specific condition being tested. Such a development could revolutionize the way we conduct and analyze EEG studies, offering greater flexibility in experimental design and more nuanced insights into brain activity.</p>
<p>Below, we’ll demonstrate some functions from <a href="https://github.com/pablobernabeu/EEG-tools-and-tips">this GitHub repository</a> that help inspect and fix vmrk files. We’ll work with the vmrk file shown below.</p>
<pre class="r"><code># Read the file into a vector of lines
readLines(&#39;https://raw.githubusercontent.com/pablobernabeu/EEG-tools-and-tips/main/example.vmrk&#39;)</code></pre>
<pre><code>##  [1] &quot;Brain Vision Data Exchange Marker File, Version 1.0&quot;                               
##  [2] &quot;&quot;                                                                                  
##  [3] &quot;[Common Infos]&quot;                                                                    
##  [4] &quot;DataFile=3.eeg&quot;                                                                    
##  [5] &quot;Codepage=utf-8&quot;                                                                    
##  [6] &quot;&quot;                                                                                  
##  [7] &quot;[Marker Infos]&quot;                                                                    
##  [8] &quot;; Each entry: Mk&lt;Marker number&gt;=&lt;Type&gt;,&lt;Description&gt;,&lt;Position in data points&gt;,&quot;   
##  [9] &quot;; &lt;Size in data points&gt;, &lt;Channel number (0 = marker is related to all channels)&gt;,&quot;
## [10] &quot;; &lt;Date (YYYYMMDDhhmmssuuuuuu)&gt;&quot;                                                   
## [11] &quot;; Fields are delimited by commas, some fields might be omited (empty).&quot;            
## [12] &quot;; Commas in type or description text are coded as \&quot;\\1\&quot;.&quot;                        
## [13] &quot;Mk1=New Segment,,1,1,0,20240318111955090000&quot;                                       
## [14] &quot;Mk2=Stimulus,S254,20419,1,0&quot;                                                       
## [15] &quot;Mk3=Stimulus,S  5,22332,1,0&quot;                                                       
## [16] &quot;Mk4=Stimulus,S 42,23095,1,0&quot;                                                       
## [17] &quot;Mk5=Stimulus,S143,23100,1,0&quot;                                                       
## [18] &quot;Mk6=Stimulus,S  2,23106,1,0&quot;                                                       
## [19] &quot;Mk7=Stimulus,S102,23111,1,0&quot;                                                       
## [20] &quot;Mk8=Stimulus,S  6,25882,1,0&quot;                                                       
## [21] &quot;Mk9=Stimulus,S  5,28106,1,0&quot;                                                       
## [22] &quot;Mk10=Stimulus,S 50,29053,1,0&quot;                                                      
## [23] &quot;Mk11=Stimulus,S241,29058,1,0&quot;                                                      
## [24] &quot;Mk12=Stimulus,S  1,29063,1,0&quot;                                                      
## [25] &quot;Mk13=Stimulus,S101,29069,1,0&quot;                                                      
## [26] &quot;Mk14=Stimulus,S  6,31830,1,0&quot;                                                      
## [27] &quot;Mk15=Stimulus,S  5,34056,1,0&quot;                                                      
## [28] &quot;Mk16=Stimulus,S 49,35055,1,0&quot;                                                      
## [29] &quot;Mk17=Stimulus,S226,35060,1,0&quot;                                                      
## [30] &quot;Mk18=Stimulus,S  2,35066,1,0&quot;                                                      
## [31] &quot;Mk19=Stimulus,S103,35071,1,0&quot;                                                      
## [32] &quot;Mk20=Stimulus,S  6,37242,1,0&quot;                                                      
## [33] &quot;Mk21=Stimulus,S  5,39436,1,0&quot;                                                      
## [34] &quot;Mk22=Stimulus,S 43,40417,1,0&quot;                                                      
## [35] &quot;Mk23=Stimulus,S155,40423,1,0&quot;                                                      
## [36] &quot;Mk24=Stimulus,S  2,40429,1,0&quot;                                                      
## [37] &quot;Mk25=Stimulus,S103,40434,1,0&quot;                                                      
## [38] &quot;Mk26=Stimulus,S  6,42481,1,0&quot;                                                      
## [39] &quot;Mk27=Stimulus,S  5,44662,1,0&quot;                                                      
## [40] &quot;Mk28=Stimulus,S 40,45678,1,0&quot;                                                      
## [41] &quot;Mk29=Stimulus,S118,45683,1,0&quot;                                                      
## [42] &quot;Mk30=Stimulus,S  1,45688,1,0&quot;                                                      
## [43] &quot;Mk31=Stimulus,S103,45693,1,0&quot;                                                      
## [44] &quot;Mk32=Stimulus,S  6,47621,1,0&quot;                                                      
## [45] &quot;Mk33=Stimulus,S  5,49809,1,0&quot;                                                      
## [46] &quot;Mk34=Stimulus,S 50,50808,1,0&quot;                                                      
## [47] &quot;Mk35=Stimulus,S237,50813,1,0&quot;                                                      
## [48] &quot;Mk36=Stimulus,S  3,50818,1,0&quot;                                                      
## [49] &quot;Mk37=Stimulus,S101,50823,1,0&quot;                                                      
## [50] &quot;Mk38=Stimulus,S  6,53823,1,0&quot;                                                      
## [51] &quot;Mk39=Stimulus,S  5,56042,1,0&quot;                                                      
## [52] &quot;Mk40=Stimulus,S 40,57129,1,0&quot;                                                      
## [53] &quot;Mk41=Stimulus,S114,57134,1,0&quot;                                                      
## [54] &quot;Mk42=Stimulus,S  3,57140,1,0&quot;                                                      
## [55] &quot;Mk43=Stimulus,S103,57145,1,0&quot;                                                      
## [56] &quot;Mk44=Stimulus,S  6,59661,1,0&quot;</code></pre>
<div id="numbering-trials" class="section level2">
<h2>Numbering trials</h2>
<p>The antediluvian limitation of markers often prevents us from storing the order of trials using markers. Thus, when we need to inspect or fix vmrk files, we must mentally divide the lines into trials. For instance, in our example vmrk file, all trials begin with the marker <code>S  5</code>. The function below allows us to temporarily number trials by appending the number to the first marker of each trial. The parameters of the function allow us to select the <code>start_line</code> to skip the metadata at the top of the vmrk file, as well as to select the number of <code>lines_per_trial</code> and the <code>first_number</code> to use in the first trial.</p>
<script src="https://emgithub.com/embed-v2.js?target=https%3A%2F%2Fgithub.com%2Fpablobernabeu%2FEEG-tools-and-tips%2Fblob%2Fmain%2Fnumber_trials.R%23L3-L24&style=a11y-dark&type=code&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on"></script>
<pre class="r"><code># Create temporary vmrk file with numbered trials

source(&#39;https://raw.githubusercontent.com/pablobernabeu/EEG-tools-and-tips/main/number_trials.R&#39;)

number_trials(&#39;https://raw.githubusercontent.com/pablobernabeu/EEG-tools-and-tips/main/example.vmrk&#39;, 
              start_line = 15, lines_per_trial = 6, first_number = 1)</code></pre>
<pre><code>##  [1] &quot;Brain Vision Data Exchange Marker File, Version 1.0&quot;                               
##  [2] &quot;&quot;                                                                                  
##  [3] &quot;[Common Infos]&quot;                                                                    
##  [4] &quot;DataFile=3.eeg&quot;                                                                    
##  [5] &quot;Codepage=utf-8&quot;                                                                    
##  [6] &quot;&quot;                                                                                  
##  [7] &quot;[Marker Infos]&quot;                                                                    
##  [8] &quot;; Each entry: Mk&lt;Marker number&gt;=&lt;Type&gt;,&lt;Description&gt;,&lt;Position in data points&gt;,&quot;   
##  [9] &quot;; &lt;Size in data points&gt;, &lt;Channel number (0 = marker is related to all channels)&gt;,&quot;
## [10] &quot;; &lt;Date (YYYYMMDDhhmmssuuuuuu)&gt;&quot;                                                   
## [11] &quot;; Fields are delimited by commas, some fields might be omited (empty).&quot;            
## [12] &quot;; Commas in type or description text are coded as \&quot;\\1\&quot;.&quot;                        
## [13] &quot;Mk1=New Segment,,1,1,0,20240318111955090000&quot;                                       
## [14] &quot;Mk2=Stimulus,S254,20419,1,0&quot;                                                       
## [15] &quot;Mk3=Stimulus,S  5,22332,1,0  1&quot;                                                    
## [16] &quot;Mk4=Stimulus,S 42,23095,1,0&quot;                                                       
## [17] &quot;Mk5=Stimulus,S143,23100,1,0&quot;                                                       
## [18] &quot;Mk6=Stimulus,S  2,23106,1,0&quot;                                                       
## [19] &quot;Mk7=Stimulus,S102,23111,1,0&quot;                                                       
## [20] &quot;Mk8=Stimulus,S  6,25882,1,0&quot;                                                       
## [21] &quot;Mk9=Stimulus,S  5,28106,1,0  2&quot;                                                    
## [22] &quot;Mk10=Stimulus,S 50,29053,1,0&quot;                                                      
## [23] &quot;Mk11=Stimulus,S241,29058,1,0&quot;                                                      
## [24] &quot;Mk12=Stimulus,S  1,29063,1,0&quot;                                                      
## [25] &quot;Mk13=Stimulus,S101,29069,1,0&quot;                                                      
## [26] &quot;Mk14=Stimulus,S  6,31830,1,0&quot;                                                      
## [27] &quot;Mk15=Stimulus,S  5,34056,1,0  3&quot;                                                   
## [28] &quot;Mk16=Stimulus,S 49,35055,1,0&quot;                                                      
## [29] &quot;Mk17=Stimulus,S226,35060,1,0&quot;                                                      
## [30] &quot;Mk18=Stimulus,S  2,35066,1,0&quot;                                                      
## [31] &quot;Mk19=Stimulus,S103,35071,1,0&quot;                                                      
## [32] &quot;Mk20=Stimulus,S  6,37242,1,0&quot;                                                      
## [33] &quot;Mk21=Stimulus,S  5,39436,1,0  4&quot;                                                   
## [34] &quot;Mk22=Stimulus,S 43,40417,1,0&quot;                                                      
## [35] &quot;Mk23=Stimulus,S155,40423,1,0&quot;                                                      
## [36] &quot;Mk24=Stimulus,S  2,40429,1,0&quot;                                                      
## [37] &quot;Mk25=Stimulus,S103,40434,1,0&quot;                                                      
## [38] &quot;Mk26=Stimulus,S  6,42481,1,0&quot;                                                      
## [39] &quot;Mk27=Stimulus,S  5,44662,1,0  5&quot;                                                   
## [40] &quot;Mk28=Stimulus,S 40,45678,1,0&quot;                                                      
## [41] &quot;Mk29=Stimulus,S118,45683,1,0&quot;                                                      
## [42] &quot;Mk30=Stimulus,S  1,45688,1,0&quot;                                                      
## [43] &quot;Mk31=Stimulus,S103,45693,1,0&quot;                                                      
## [44] &quot;Mk32=Stimulus,S  6,47621,1,0&quot;                                                      
## [45] &quot;Mk33=Stimulus,S  5,49809,1,0  6&quot;                                                   
## [46] &quot;Mk34=Stimulus,S 50,50808,1,0&quot;                                                      
## [47] &quot;Mk35=Stimulus,S237,50813,1,0&quot;                                                      
## [48] &quot;Mk36=Stimulus,S  3,50818,1,0&quot;                                                      
## [49] &quot;Mk37=Stimulus,S101,50823,1,0&quot;                                                      
## [50] &quot;Mk38=Stimulus,S  6,53823,1,0&quot;                                                      
## [51] &quot;Mk39=Stimulus,S  5,56042,1,0  7&quot;                                                   
## [52] &quot;Mk40=Stimulus,S 40,57129,1,0&quot;                                                      
## [53] &quot;Mk41=Stimulus,S114,57134,1,0&quot;                                                      
## [54] &quot;Mk42=Stimulus,S  3,57140,1,0&quot;                                                      
## [55] &quot;Mk43=Stimulus,S103,57145,1,0&quot;                                                      
## [56] &quot;Mk44=Stimulus,S  6,59661,1,0&quot;</code></pre>
</div>
<div id="removing-trial-numbers" class="section level2">
<h2>Removing trial numbers</h2>
<script src="https://emgithub.com/embed-v2.js?target=https%3A%2F%2Fgithub.com%2Fpablobernabeu%2FEEG-tools-and-tips%2Fblob%2Fmain%2Fremove_trial_numbers.R%23L3-L20&style=a11y-dark&type=code&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on"></script>
<p>Now, we will unnumber the trials. This can be especially useful after fixing any errors in the markers. For this demo, we’ll use an <a href="https://github.com/pablobernabeu/EEG-tools-and-tips/blob/main/example_numbered_trials.vmrk">example file with numbered trials</a> that looks just like the output from <code>number_trials()</code> shown above.</p>
<pre class="r"><code># Remove trial numbers from temporary vmrk file

source(&#39;https://raw.githubusercontent.com/pablobernabeu/EEG-tools-and-tips/main/remove_trial_numbers.R&#39;)

remove_trial_numbers(&#39;https://raw.githubusercontent.com/pablobernabeu/EEG-tools-and-tips/main/example_numbered_trials.vmrk&#39;)</code></pre>
<pre><code>##  [1] &quot;Brain Vision Data Exchange Marker File, Version 1.0&quot;                               
##  [2] &quot;&quot;                                                                                  
##  [3] &quot;[Common Infos]&quot;                                                                    
##  [4] &quot;DataFile=3.eeg&quot;                                                                    
##  [5] &quot;Codepage=utf-8&quot;                                                                    
##  [6] &quot;&quot;                                                                                  
##  [7] &quot;[Marker Infos]&quot;                                                                    
##  [8] &quot;; Each entry: Mk&lt;Marker number&gt;=&lt;Type&gt;,&lt;Description&gt;,&lt;Position in data points&gt;,&quot;   
##  [9] &quot;; &lt;Size in data points&gt;, &lt;Channel number (0 = marker is related to all channels)&gt;,&quot;
## [10] &quot;; &lt;Date (YYYYMMDDhhmmssuuuuuu)&gt;&quot;                                                   
## [11] &quot;; Fields are delimited by commas, some fields might be omited (empty).&quot;            
## [12] &quot;; Commas in type or description text are coded as \&quot;\\1\&quot;.&quot;                        
## [13] &quot;Mk1=New Segment,,1,1,0,20240318111955090000&quot;                                       
## [14] &quot;Mk2=Stimulus,S254,20419,1,0&quot;                                                       
## [15] &quot;Mk3=Stimulus,S  5,22332,1,0&quot;                                                       
## [16] &quot;Mk4=Stimulus,S 42,23095,1,0&quot;                                                       
## [17] &quot;Mk5=Stimulus,S143,23100,1,0&quot;                                                       
## [18] &quot;Mk6=Stimulus,S  2,23106,1,0&quot;                                                       
## [19] &quot;Mk7=Stimulus,S102,23111,1,0&quot;                                                       
## [20] &quot;Mk8=Stimulus,S  6,25882,1,0&quot;                                                       
## [21] &quot;Mk9=Stimulus,S  5,28106,1,0&quot;                                                       
## [22] &quot;Mk10=Stimulus,S 50,29053,1,0&quot;                                                      
## [23] &quot;Mk11=Stimulus,S241,29058,1,0&quot;                                                      
## [24] &quot;Mk12=Stimulus,S  1,29063,1,0&quot;                                                      
## [25] &quot;Mk13=Stimulus,S101,29069,1,0&quot;                                                      
## [26] &quot;Mk14=Stimulus,S  6,31830,1,0&quot;                                                      
## [27] &quot;Mk15=Stimulus,S  5,34056,1,0&quot;                                                      
## [28] &quot;Mk16=Stimulus,S 49,35055,1,0&quot;                                                      
## [29] &quot;Mk17=Stimulus,S226,35060,1,0&quot;                                                      
## [30] &quot;Mk18=Stimulus,S  2,35066,1,0&quot;                                                      
## [31] &quot;Mk19=Stimulus,S103,35071,1,0&quot;                                                      
## [32] &quot;Mk20=Stimulus,S  6,37242,1,0&quot;                                                      
## [33] &quot;Mk21=Stimulus,S  5,39436,1,0&quot;                                                      
## [34] &quot;Mk22=Stimulus,S 43,40417,1,0&quot;                                                      
## [35] &quot;Mk23=Stimulus,S155,40423,1,0&quot;                                                      
## [36] &quot;Mk24=Stimulus,S  2,40429,1,0&quot;                                                      
## [37] &quot;Mk25=Stimulus,S103,40434,1,0&quot;                                                      
## [38] &quot;Mk26=Stimulus,S  6,42481,1,0&quot;                                                      
## [39] &quot;Mk27=Stimulus,S  5,44662,1,0&quot;                                                      
## [40] &quot;Mk28=Stimulus,S 40,45678,1,0&quot;                                                      
## [41] &quot;Mk29=Stimulus,S118,45683,1,0&quot;                                                      
## [42] &quot;Mk30=Stimulus,S  1,45688,1,0&quot;                                                      
## [43] &quot;Mk31=Stimulus,S103,45693,1,0&quot;                                                      
## [44] &quot;Mk32=Stimulus,S  6,47621,1,0&quot;                                                      
## [45] &quot;Mk33=Stimulus,S  5,49809,1,0&quot;                                                      
## [46] &quot;Mk34=Stimulus,S 50,50808,1,0&quot;                                                      
## [47] &quot;Mk35=Stimulus,S237,50813,1,0&quot;                                                      
## [48] &quot;Mk36=Stimulus,S  3,50818,1,0&quot;                                                      
## [49] &quot;Mk37=Stimulus,S101,50823,1,0&quot;                                                      
## [50] &quot;Mk38=Stimulus,S  6,53823,1,0&quot;                                                      
## [51] &quot;Mk39=Stimulus,S  5,56042,1,0&quot;                                                      
## [52] &quot;Mk40=Stimulus,S 40,57129,1,0&quot;                                                      
## [53] &quot;Mk41=Stimulus,S114,57134,1,0&quot;                                                      
## [54] &quot;Mk42=Stimulus,S  3,57140,1,0&quot;                                                      
## [55] &quot;Mk43=Stimulus,S103,57145,1,0&quot;                                                      
## [56] &quot;Mk44=Stimulus,S  6,59661,1,0&quot;</code></pre>
</div>
<div id="counting-markers" class="section level2">
<h2>Counting markers</h2>
<script src="https://emgithub.com/embed-v2.js?target=https%3A%2F%2Fgithub.com%2Fpablobernabeu%2FEEG-tools-and-tips%2Fblob%2Fmain%2Fcount_markers.R%23L3-L18&style=a11y-dark&type=code&showLineNumbers=on&showFileMeta=on&showCopy=on&fetchFromJsDelivr=on"></script>
<pre class="r"><code>source(&#39;https://raw.githubusercontent.com/pablobernabeu/EEG-tools-and-tips/main/count_markers.R&#39;)

count_markers(file = &#39;https://raw.githubusercontent.com/pablobernabeu/EEG-tools-and-tips/main/example.vmrk&#39;, 
              marker = &#39;S  2&#39;)</code></pre>
<pre><code>## Count of &quot;S  2&quot;: 3 instances</code></pre>
<pre class="r"><code>count_markers(file = &#39;https://raw.githubusercontent.com/pablobernabeu/EEG-tools-and-tips/main/example.vmrk&#39;, 
              marker = &#39;S  3&#39;)</code></pre>
<pre><code>## Count of &quot;S  3&quot;: 2 instances</code></pre>
</div>

    </div>

    



<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/research-methods/">research methods</a>
  
  <a class="badge badge-light" href="/tags/electroencephalography/">electroencephalography</a>
  
  <a class="badge badge-light" href="/tags/eeg/">EEG</a>
  
  <a class="badge badge-light" href="/tags/brainvision/">BrainVision</a>
  
  <a class="badge badge-light" href="/tags/event-related-potentials/">event-related potentials</a>
  
  <a class="badge badge-light" href="/tags/s/">s</a>
  
</div>










<section id="comments">
  
    
<div id="disqus_thread"></div>
<script>
  let disqus_config = function () {
    
    
    
  };
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); s.async = true;
    s.src = 'https://' + "pablobernabeu-github-io" + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  
</section>






  
  



  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/htmlbars.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/css.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/javascript.min.js"></script>
        
      

    

    
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":2,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"   Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'presentation' : "Presentations"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.ec6eff62178eeeed9ad7206cec9368b8.js"></script>

    
    
    <script src="/js/indexnow.js"></script>
    

    
<script>
document.addEventListener('DOMContentLoaded', function() {
  
  if (window.innerWidth <= 991) {
    const toggler = document.querySelector('.navbar-toggler');
    const navbarCollapse = document.querySelector('#navbar-content');
    
    if (toggler && navbarCollapse) {
      
      toggler.addEventListener('mouseenter', function() {
        if (!navbarCollapse.classList.contains('show')) {
          $(navbarCollapse).collapse('show');
        }
      });
      
      
      
    }
  }
  
  
  if (typeof $ !== 'undefined') {
    $('[data-toggle="tooltip"]').tooltip('disable');
    $('[data-toggle="popover"]').popover('disable');
  }
});
</script>


<script src="/js/article-ancillary-tags.js"></script>



  
  
  <div class="container">
    



<footer class="site-footer">
  
  <p class="powered-by">
    Pablo Bernabeu, 2015—2026. Licence: <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Email: <a href="mailto:pcbernabeu@gmail.com">pcbernabeu@gmail.com</a>. Cookies only used by third-party systems such as <a href="https://help.disqus.com/en/articles/1717155-use-of-cookies">Disqus</a>. &middot; 

    Website powered by the <a href="https://themes.gohugo.io/themes/starter-hugo-academic" rel="noopener">Academic theme</a> for <a href="https://gohugo.io" rel="noopener">Hugo</a> and by <a href='https://github.com/rstudio/blogdown' rel="noopener">blogdown</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top" style="background-image:none;">
        <span class="button_icon" style="background-image:none;">
          <i class="fas fa-chevron-up fa-2x" style="background-image:none;"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Citation</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
